 LOG  Auth state changed: TOKEN_REFRESHED
 LOG  ğŸ¤ VOICE_BUTTON: iOS - Starting continuous conversation
 LOG  ğŸ¤ Starting continuous conversation (iOS mode)
 LOG  ğŸ¤ iOS: Starting continuous conversation mode...
 LOG  ğŸ” iOS: Requesting permissions...
 LOG  ğŸ” iOS: Permissions result: true
 LOG  ğŸ“± iOS: Calling native startContinuousConversation...
 LOG  ğŸ“± iOS: Continuous conversation started: true
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: listening
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: listening
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”´ VoiceAssistant: isSpeaking changed: false
 LOG  ğŸ”´ VoiceAssistant: voiceState: listening
 LOG  ğŸ”´ VoiceAssistant: typeof voiceState: string
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_CONTEXT: ========== CONTEXT STATE CHANGE ==========
 LOG  ğŸ”„ VOICE_CONTEXT: Context voiceState: listening
 LOG  ğŸ”„ VOICE_CONTEXT: Context isListening: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isSpeaking: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isError: false
 LOG  ğŸ”„ VOICE_CONTEXT: ====================================================
 LOG  ğŸ“ Transcript update: Hello
 LOG  Speech recognized: Hello
 LOG  ğŸ” RN_BRIDGE_DEBUG: ========== PROCESS TEXT FROM NATIVE ==========
 LOG  ğŸ” RN_BRIDGE_DEBUG: Event received at: 2025-07-30T11:23:46.190Z
 LOG  ğŸ” RN_BRIDGE_DEBUG: Event data: {
  "requestId": "49E64D4C-0E47-4412-8360-BF8487BC5D49",
  "text": "Hello"
}
 LOG  ğŸ” RN_BRIDGE_DEBUG: Text to process: Hello
 LOG  ğŸ” RN_BRIDGE_DEBUG: Request ID: 49E64D4C-0E47-4412-8360-BF8487BC5D49
 LOG  ğŸ” RN_BRIDGE_DEBUG: Current voice state: idle
 LOG  ğŸ” RN_BRIDGE_DEBUG: Chat history length: 0
 LOG  ğŸ” RN_BRIDGE_DEBUG: API loading state: false
 LOG  ğŸ” RN_BRIDGE_DEBUG: Thread info: {"performanceNow": 180451544.158166, "timestamp": 1753874626190}
 LOG  ğŸŸ¡ VOICE_SERVICE: Adding user message to chat history
 LOG  ğŸ• Setting auto-refresh timer for 10 minutes
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: listening
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: listening
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”´ VoiceAssistant: isSpeaking changed: false
 LOG  ğŸ”´ VoiceAssistant: voiceState: idle
 LOG  ğŸ”´ VoiceAssistant: typeof voiceState: string
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_CONTEXT: ========== CONTEXT STATE CHANGE ==========
 LOG  ğŸ”„ VOICE_CONTEXT: Context voiceState: idle
 LOG  ğŸ”„ VOICE_CONTEXT: Context isListening: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isSpeaking: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isError: false
 LOG  ğŸ”„ VOICE_CONTEXT: ====================================================
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: processing
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: processing
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ“ Transcript update: Hello
 LOG  ğŸ”´ VoiceAssistant: isSpeaking changed: false
 LOG  ğŸ”´ VoiceAssistant: voiceState: processing
 LOG  ğŸ”´ VoiceAssistant: typeof voiceState: string
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_CONTEXT: ========== CONTEXT STATE CHANGE ==========
 LOG  ğŸ”„ VOICE_CONTEXT: Context voiceState: processing
 LOG  ğŸ”„ VOICE_CONTEXT: Context isListening: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isSpeaking: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isError: false
 LOG  ğŸ”„ VOICE_CONTEXT: ====================================================
 LOG  ğŸ”„ VOICE_CONTEXT: Sending message with current settings
 LOG  ğŸ” RN_BRIDGE_DEBUG: ========== STARTING API CALL ==========
 LOG  ğŸ” RN_BRIDGE_DEBUG: API call start time: 1753874626345
 LOG  ğŸ” RN_BRIDGE_DEBUG: Text being sent to API: Hello
 LOG  ğŸ” RN_BRIDGE_DEBUG: History entries count: 1
 LOG  ğŸ”´ SERVER_API: sendChatRequest called
 LOG  ğŸ”´ SERVER_API: Message: "Hello"
 LOG  ğŸ”´ SERVER_API: Generated request ID: 1753874626377-7wh9gu9up
 LOG  ğŸ“Š REQUEST_STATUS: Setting request ID for polling: 1753874626377-7wh9gu9up
 LOG  ğŸ” RN_BRIDGE_DEBUG: Request ID assigned: 1753874626377-7wh9gu9up
 LOG  ğŸ”— REQUEST_MAPPING: Mapping RN ID '1753874626377-7wh9gu9up' to native ID '49E64D4C-0E47-4412-8360-BF8487BC5D49'
 LOG  ğŸ”´ SERVER_API: Adding delay for Android stability...
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: processing
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: processing
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”´ VoiceAssistant: isSpeaking changed: false
 LOG  ğŸ”´ VoiceAssistant: voiceState: idle
 LOG  ğŸ”´ VoiceAssistant: typeof voiceState: string
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_CONTEXT: ========== CONTEXT STATE CHANGE ==========
 LOG  ğŸ”„ VOICE_CONTEXT: Context voiceState: idle
 LOG  ğŸ”„ VOICE_CONTEXT: Context isListening: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isSpeaking: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isError: false
 LOG  ğŸ”„ VOICE_CONTEXT: ====================================================
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: error
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: error
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”´ VoiceAssistant: isSpeaking changed: false
 LOG  ğŸ”´ VoiceAssistant: voiceState: error
 LOG  ğŸ”´ VoiceAssistant: typeof voiceState: string
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_CONTEXT: ========== CONTEXT STATE CHANGE ==========
 LOG  ğŸ”„ VOICE_CONTEXT: Context voiceState: error
 LOG  ğŸ”„ VOICE_CONTEXT: Context isListening: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isSpeaking: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isError: false
 LOG  ğŸ”„ VOICE_CONTEXT: ====================================================
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: error
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: error
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”´ VoiceAssistant: isSpeaking changed: false
 LOG  ğŸ”´ VoiceAssistant: voiceState: idle
 LOG  ğŸ”´ VoiceAssistant: typeof voiceState: string
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_CONTEXT: ========== CONTEXT STATE CHANGE ==========
 LOG  ğŸ”„ VOICE_CONTEXT: Context voiceState: idle
 LOG  ğŸ”„ VOICE_CONTEXT: Context isListening: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isSpeaking: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isError: false
 LOG  ğŸ”„ VOICE_CONTEXT: ====================================================
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: error
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: error
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”´ VoiceAssistant: isSpeaking changed: false
 LOG  ğŸ”´ VoiceAssistant: voiceState: error
 LOG  ğŸ”´ VoiceAssistant: typeof voiceState: string
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_CONTEXT: ========== CONTEXT STATE CHANGE ==========
 LOG  ğŸ”„ VOICE_CONTEXT: Context voiceState: error
 LOG  ğŸ”„ VOICE_CONTEXT: Context isListening: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isSpeaking: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isError: false
 LOG  ğŸ”„ VOICE_CONTEXT: ====================================================
 LOG  ğŸ”´ SERVER_API: History[0]: {"content": "Hello", "contentLength": 5, "role": "user", "timestamp": 1753874626190}
 LOG  ğŸ”´ SERVER_API: Full request payload: {
  "message": "Hello",
  "timestamp": 1753874626554,
  "history": [
    {
      "role": "user",
      "content": "Hello",
      "timestamp": 1753874626190,
      "type": "text"
    }
  ],
  "preferences": {
    "voice": "male",
    "response_type": "concise"
  },
  "request_id": "1753874626377-7wh9gu9up"
}
 LOG  ğŸ” API Interceptor: Starting auth check for request to: /api/chat
 LOG  ğŸ“± Platform: ios
 LOG  ğŸ” API Interceptor: User check result: User ID: 5feaa57b-85b1-4002-8950-dfd9cbd8c77f
 LOG  ğŸ” API Interceptor: Session check result: Token exists: true
 LOG  âœ… API Interceptor: Auth token added to request
 LOG  ğŸ” API Interceptor: Final headers: {"Accept": "application/json, text/plain, */*", "Authorization": "[REDACTED]", "Content-Type": "multipart/form-data"}
 LOG  Cancelling current request...
 LOG  ğŸš« CANCEL_WRAPPER: Cancelling request and updating UI status...
 LOG  ğŸš« CANCEL: Cancelling server request and clearing native state...
 LOG  ğŸ”´ SERVER_API: Cancelling current request... 1753874626377-7wh9gu9up
 LOG  âœ… SERVER_API: Cancellation request inserted into database
 LOG  âœ… SERVER_API: Request cancelled successfully
 ERROR  âŒ API Response Error: undefined /api/chat
 ERROR  ğŸ”´ SERVER_API: âŒ API request error: [CanceledError: canceled]
 ERROR  ğŸ”´ SERVER_API: API request failed in queue
 LOG  ğŸ”— REQUEST_MAPPING: RN ID '1753874626377-7wh9gu9up' maps to native ID '49E64D4C-0E47-4412-8360-BF8487BC5D49'
 LOG  ğŸ§¹ CANCEL: Clearing native state for specific request: 49E64D4C-0E47-4412-8360-BF8487BC5D49
 LOG  ğŸ§¹ NATIVE_CLEANUP: Clearing iOS native state for request: 49E64D4C-0E47-4412-8360-BF8487BC5D49...
 LOG  ğŸ”´ SERVER_API: Request was cancelled
 ERROR  ğŸŸ  VOICE_CONTEXT: âŒ Error processing text request: [Error: Request was cancelled]
 LOG  ğŸŸ  VOICE_CONTEXT: Request was cancelled - not sending error to native
 LOG  ğŸ§¹ NATIVE_CLEANUP: âœ… iOS native state cleared successfully
 LOG  ğŸ”— REQUEST_MAPPING: Removing mapping for RN ID '1753874626377-7wh9gu9up' and native ID '49E64D4C-0E47-4412-8360-BF8487BC5D49'
 LOG  ğŸ§¹ CANCEL: âœ… Native state cleared after cancellation
 LOG  ğŸš« CANCEL: âœ… Request cancelled successfully
 LOG  ğŸš« CANCEL_WRAPPER: Request cancelled successfully, clearing status in 2 seconds
 LOG  Cancel result: true
 LOG  âœ… Request cancelled successfully
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: error
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: error
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”´ VoiceAssistant: isSpeaking changed: false
 LOG  ğŸ”´ VoiceAssistant: voiceState: idle
 LOG  ğŸ”´ VoiceAssistant: typeof voiceState: string
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_CONTEXT: ========== CONTEXT STATE CHANGE ==========
 LOG  ğŸ”„ VOICE_CONTEXT: Context voiceState: idle
 LOG  ğŸ”„ VOICE_CONTEXT: Context isListening: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isSpeaking: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isError: false
 LOG  ğŸ”„ VOICE_CONTEXT: ====================================================
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: speaking
 LOG  ğŸ”´ useVoiceState: SPEAKING state detected!
 LOG  ğŸ”´ useVoiceState: normalizedState: speaking
 LOG  ğŸ”´ useVoiceState: VoiceState.SPEAKING: SPEAKING
 LOG  ğŸ”´ useVoiceState: isSpeaking: true
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - Previous state: idle
 LOG  ğŸ”„ VOICE_STATE_HOOK: Functional setState - New state: speaking
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”´ useVoiceState: SPEAKING state detected!
 LOG  ğŸ”´ useVoiceState: normalizedState: speaking
 LOG  ğŸ”´ useVoiceState: VoiceState.SPEAKING: SPEAKING
 LOG  ğŸ”´ useVoiceState: isSpeaking: true
 LOG  ğŸ”´ useVoiceState: SPEAKING state detected!
 LOG  ğŸ”´ useVoiceState: normalizedState: speaking
 LOG  ğŸ”´ useVoiceState: VoiceState.SPEAKING: SPEAKING
 LOG  ğŸ”´ useVoiceState: isSpeaking: true
 LOG  ğŸ”„ VOICE_STATE_HOOK: setVoiceState called - React should update now
 LOG  ğŸ”´ VoiceAssistant: isSpeaking changed: true
 LOG  ğŸ”´ VoiceAssistant: voiceState: speaking
 LOG  ğŸ”´ VoiceAssistant: typeof voiceState: string
 LOG  ğŸ”„ VOICE_STATE_HOOK: ========== HOOK STATE CHANGE DETECTED ==========
 LOG  ğŸ”„ VOICE_CONTEXT: ========== CONTEXT STATE CHANGE ==========
 LOG  ğŸ”„ VOICE_CONTEXT: Context voiceState: speaking
 LOG  ğŸ”„ VOICE_CONTEXT: Context isListening: false
 LOG  ğŸ”„ VOICE_CONTEXT: Context isSpeaking: true
 LOG  ğŸ”„ VOICE_CONTEXT: Context isError: false
 LOG  ğŸ”„ VOICE_CONTEXT: ====================================================
 LOG  ğŸ”´ useVoiceState: SPEAKING state detected!
 LOG  ğŸ”´ useVoiceState: normalizedState: speaking
 LOG  ğŸ”´ useVoiceState: VoiceState.SPEAKING: SPEAKING
 LOG  ğŸ”´ useVoiceState: isSpeaking: true
